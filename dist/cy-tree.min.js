"use strict";!function(a){var b=a.module("cyTree",[]);b.service("cyTreeUtils",[function(){function a(b,c,d){if(b&&b[c])for(var e,f=b[c],g=f.length;g--;)e=f[g],d&&d(e),a(e)}var b=0,c="cyTree",d=function(){},e=d;this.genUniqueId=function(){return c+ ++b},this.getTreeCount=function(){return b},this.iterateTree=function(a,b,c){var d,e,f=a&&a.length;if(f&&c)for(;f--;)e=a[f],d=e[b],c(e),iterate(d,b,c)},this.template=function(a){return"function"!=typeof a?e:void(e=a)},this.formatData=function(b,c,d,e,f){if(!b||!b.length)return[];var g,h=b.length,i={};for(f=f||function(){};h--;){var j=b[h],k=j[d];f(j),k===c&&(g=j),i[k]||(i[k]=[]),i[k].push(j)}return g.list=i[c],a(g,"list",function(a){a.list=i[a[e]]}),[g]},this.iterate=a}]),b.directive("treeModel",["$q","$log","$compile","$templateCache","cyTreeUtils",function(a,b,c,d,e){function f(a,b){var c,d,e=a.list;if(e&&e.length)for(c=0,d=e.length;d>c;c++)e[c].selected=b,f(e[c],b)}return{restrict:"A",scope:!0,link:function(a,g,h){var i=function(){h.debugMode&&b.debug&&b.debug.apply(this,arguments)};i("cyTree:about to init");var j=h.keepRawData,k=h.treeData,l=d.get("cy-tree-template/tree.html");k?l.replace(/treeData/g,k):k="treeData",j||e.iterateTree(a[k],"list",function(a,b){b&&b.length&&(a.collapsed=!0)}),i("cyTree:inited, (keepRawData, treeData)",j,k),h.cyTree&&(i("cyTree:about to add behavior"),a.treeMethods=a.treeMethods||{},a.treeId=e.genUniqueId(),a.treeMethods.collapseNode=a[treeId].collapseNode||function(b){b.expanded=!b.expanded,i("cyTree:collapseNode",a.treeId)},a.treeMethods.selectNode=a[treeId].selectNode||function(b,c){var d,e,g,h=!0,j=b.selected,k=!j;if(b.selected=k,c){for(g=c.list,d=0,e=g.length;e>d;d++)if(g[d].selected!==!0){h=!1;break}c.selected=h?!0:!1}f(b,k),a[treeId].currentNode=b,i("cyTree:selectNode",a.treeId)}),i("cyTree:about to render tree, treeId is",a.treeId),g.html("").append(c(l)(a))}}}]),b.run(["$templateCache",function(a){a.put("cy-tree-template/tree.html",'<ul><li ng-repeat="node in treeData"><i class="css-icon" ng-if="node.list" ng-click="treeMethods.collapseNode(node)" ng-class="{\'icon-add\': node.collapsed, \'icon-minus\': !node.collapsed}"></i><i class="css-icon" ng-class="{\'icon-box\': node.selected, \'icon-success\': !node.selected}" ng-click="treeMethods.selectNode(node, parentNode)"></i><span>{{node.name}}</span></li></ul>')}])}(angular);